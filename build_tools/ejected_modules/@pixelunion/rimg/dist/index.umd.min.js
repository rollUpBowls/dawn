/*!
 * @pixelunion/rimg v2.2.2
 * (c) 2022 Pixel Union
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self)["@pixelunion/rimg"]=e()}(this,function(){"use strict";var t={scale:1,template:!1,templateRender:function(t,e){return t.replace("{size}","".concat(e.width,"x").concat(e.height))},max:{width:1/0,height:1/0},round:32,placeholder:!1,crop:null};function e(e,i,n,a){var r="data-rimg-".concat(i);if(!e.hasAttribute(r))return n[i]||t[i];var o=e.getAttribute(r);return a?a(o):o}function i(t){return t=t.split("x"),{width:parseInt(t[0],10),height:parseInt(t[1],10)}}function n(t){switch(t){case"top":case"center":case"bottom":case"left":case"right":return t;default:return null}}function a(a){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=a.hasAttribute("data-rimg-template");return{el:a,isImage:o,isBackgroundImage:o&&"IMG"!==a.tagName,scale:parseInt(e(a,"scale",r)),density:window.devicePixelRatio||1,template:e(a,"template",r),templateRender:r.templateRender||t.templateRender,max:e(a,"max",r,i),round:e(a,"round",r),placeholder:e(a,"placeholder",r,i),crop:e(a,"crop",r,n)}}function r(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;return 0===t?e:Math.min(Math.ceil(t/e)*e,i)}function o(t,e){var i=document.createEvent("Event");return i.initEvent(e,!0,!0),!t.dispatchEvent(i)}function d(t,e,i,n){var a,o,d,h=t.templateRender,c=i?1:(o=e,Math.min(Math.min(Math.max((a=t).max.width/o.width,1),a.density),Math.min(Math.max(a.max.height/o.height,1),a.density)).toFixed(2)),g=i?1:t.round,l=e.width*c,u=e.height*c;if(t.crop)d={width:r(l,g,t.max.width),height:r(u,g,t.max.height)};else{var m=e.width/e.height,s=t.max.width/t.max.height;d=m>s?{width:r(l,g,t.max.width),height:r(l/s,g,t.max.height)}:{width:r(u*s,g,t.max.width),height:r(u,g,t.max.height)}}var f=h(t.template,d),v=new Image;v.onload=n,v.src=f,t.isBackgroundImage?t.el.style.backgroundImage="url('".concat(f,"')"):t.el.setAttribute("srcset","".concat(f," ").concat(c,"x"))}function h(t,e){var i=t.el;d(t,e,!1,function(t){"load"===t.type?i.setAttribute("data-rimg","loaded"):(i.setAttribute("data-rimg","error"),o(i,"rimg:error")),o(i,"rimg:load")})}function c(t){var e=t.el,i=e.getAttribute("data-rimg");if("loading"!==i&&"loaded"!==i)if(t.isBackgroundImage||0!==e.naturalWidth&&e.complete){if(!o(e,"rimg:loading")){e.setAttribute("data-rimg","loading");var n=function(t){for(var e={width:0,height:0};t&&(e.width=t.offsetWidth,e.height=t.offsetHeight,!(e.width>20&&e.height>20));)t=t.parentNode;return e}(t.el);n.width*=t.scale,n.height*=t.scale,t.placeholder?(t.isBackgroundImage||(e.setAttribute("width",Math.min(Math.floor(t.max.width/t.density),n.width)),e.setAttribute("height",Math.min(Math.floor(t.max.height/t.density),n.height))),d(t,t.placeholder,!0,function(){return h(t,n)})):h(t,n)}}else e.addEventListener("load",function i(){e.removeEventListener("load",i),c(t)})}function g(t,e){if(t){o(t,"rimg:enter");var i=a(t,e);i.isImage&&(i.isBackgroundImage||t.setAttribute("data-rimg-template-svg",t.getAttribute("srcset")),c(i))}}function l(t,e){if(t){o(t,"rimg:update");var i=a(t,e);i.isImage&&(i.isBackgroundImage||(t.setAttribute("data-rimg","lazy"),t.setAttribute("srcset",t.getAttribute("data-rimg-template-svg"))),c(i))}}function u(t){if(!t.offsetWidth||!t.offsetHeight||!t.getClientRects().length)return!1;var e=document.documentElement,i=Math.min(e.clientWidth,window.innerWidth),n=Math.min(e.clientHeight,window.innerHeight),a=t.getBoundingClientRect();return a.bottom>=0&&a.right>=0&&a.top<=n&&a.left<=i}function m(t){return"string"==typeof t?document.querySelectorAll(t):t instanceof HTMLElement?[t]:t instanceof NodeList?t:[]}return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:'[data-rimg="lazy"]',e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=new IntersectionObserver(function(t){t.forEach(function(t){(t.isIntersecting||t.intersectionRatio>0)&&(i.unobserve(t.target),g(t.target,e))})},{rootMargin:"20% 0px"}),n={track:function(){for(var t=m(arguments.length>0&&void 0!==arguments[0]?arguments[0]:'[data-rimg="lazy"]'),n=0;n<t.length;n++)u(t[n])?g(t[n],e):i.observe(t[n])},update:function(){for(var t=m(arguments.length>0&&void 0!==arguments[0]?arguments[0]:'[data-rimg="loaded"]'),i=0;i<t.length;i++)l(t[i],e)},untrack:function(){for(var t=m(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"[data-rimg]"),e=0;e<t.length;e++)i.unobserve(t[e])},load:function(){for(var t=m(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"[data-rimg]"),i=0;i<t.length;i++)g(t[i],e)},unload:function(){i.disconnect()}};return n.track(t),n}});